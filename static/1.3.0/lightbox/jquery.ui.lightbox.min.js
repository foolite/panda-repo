(function(a){a.lightbox={bindEvent:"click",overlayBgColor:"#000",overlayOpacity:0.8,fixedNavigation:false,textBtnPrev:"&lsaquo;",textBtnNext:"&rsaquo;",textBtnClose:"&times;",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Image",txtOf:"of",keyToClose:"c",keyToPrev:"p",keyToNext:"n",};a.fn.lightbox=function(e){e=a.extend({},a.lightbox,e);var b=this;function g(){f(this,b);return false}function f(t,q){a("body").addClass("lightbox-open");a("embed, object, select").css({visibility:"hidden"});n();e.images=[];e.active=0;for(var r=0;r<q.length;r++){var s=q[r];if(s.tagName=="A"){e.images.push([s.getAttribute("href"),s.getAttribute("title")])}else{if(s.tagName=="IMG"){e.images.push([s.getAttribute("src"),s.getAttribute("alt")])}}if(s==t){e.active=r}}m()}function n(){a("body").append('<div id="lightbox-overlay"></div><div id="lightbox-lightbox"><div id="lightbox-imagebox"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-btn-prev"></a><a href="#" id="lightbox-btn-next"></a></div><a href="#" id="lightbox-loading"></a></div><div id="lightbox-statusbox"><div id="lightbox-image-caption"></div><div id="lightbox-image-number"></div><a href="#" id="lightbox-btn-close">'+e.textBtnClose+"</a></div></div>");a("#lightbox-overlay").css({backgroundColor:e.overlayBgColor,opacity:e.overlayOpacity,}).fadeIn();o();a("#lightbox-overlay,#lightbox-lightbox").click(function(){d()});a("#lightbox-loading,#lightbox-btn-close").click(function(){d();return false});a(window).bind("resize",o)}function o(){a("#lightbox-imagebox").css("line-height",(a("#lightbox-imagebox").innerHeight()-2)+"px")}function m(){a("#lightbox-loading").show();if(e.fixedNavigation){a("#lightbox-image,#lightbox-statusbox").hide()}else{a("#lightbox-image,#lightbox-nav,#lightbox-btn-prev,#lightbox-btn-next,#lightbox-statusbox").hide()}var q=new Image();q.onload=function(){a("#lightbox-image").attr("src",e.images[e.active][0]);i();q.onload=function(){}};q.src=e.images[e.active][0]}function i(){a("#lightbox-loading").hide();a("#lightbox-image").fadeIn(function(){c();l()});j()}function c(){if(e.images.length>1){a("#lightbox-image-caption").html(e.images[e.active][1]);a("#lightbox-image-number").html(e.txtImage+" "+(e.active+1)+" "+e.txtOf+" "+e.images.length)}a("#lightbox-statusbox").slideDown("fast")}function l(){a("#lightbox-nav").show();a("#lightbox-btn-prev,#lightbox-btn-next").empty();if(e.active>0){var q=a("#lightbox-btn-prev").html('<span id="lightbox-txt-prev">'+e.textBtnPrev+"</span>").unbind().bind("click",function(){e.active--;m();return false});if(!e.fixedNavigation){q.show().mouseenter(function(){a(this).html('<span id="lightbox-txt-prev">'+e.textBtnPrev+"</span>")}).mouseleave(function(){a(this).empty()})}}if(e.active<e.images.length-1){var r=a("#lightbox-btn-next").html('<span id="lightbox-txt-next">'+e.textBtnNext+"</span>").unbind().bind("click",function(){e.active++;m();return false});if(!e.fixedNavigation){r.show().mouseenter(function(){a(this).html('<span id="lightbox-txt-next">'+e.textBtnNext+"</span>")}).mouseleave(function(){a(this).empty()})}}h()}function h(){a(document).keydown(function(q){p(q)})}function k(){a(document).unbind()}function p(q){if(q==null){keycode=event.keyCode;escapeKey=27}else{keycode=q.keyCode;escapeKey=q.DOM_VK_ESCAPE}key=String.fromCharCode(keycode).toLowerCase();if((key==e.keyToClose)||(key=="x")||(keycode==escapeKey)){d()}if((key==e.keyToPrev)||(keycode==37)){if(e.active!=0){e.active=e.active-1;m();k()}}if((key==e.keyToNext)||(keycode==39)){if(e.active!=(e.images.length-1)){e.active=e.active+1;m();k()}}}function j(){if(e.images.length){var q=e.active-1;(new Image()).src=e.images[q<0?e.images.length-1:q][0];q=e.active+1;(new Image()).src=e.images[q>=e.images.length?0:q][0]}}function d(){a(window).unbind("resize",o);a("#lightbox-lightbox").remove();a("#lightbox-overlay").fadeOut(function(){a("#lightbox-overlay").remove()});a("embed, object, select").css({visibility:"visible"});a("body").removeClass("lightbox-open")}return this.unbind(e.bindEvent).bind(e.bindEvent,g)}})(jQuery);